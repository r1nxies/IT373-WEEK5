{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}MySite{% endblock %}</title>

    {# Bootswatch Cosmo (Bootstrap 5) #}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5/dist/cosmo/bootstrap.min.css">

    {# Your app static CSS (loads AFTER bootswatch so you can override) #}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    {# Provide a hook for page-specific head content #}
    {% block extra_head %}{% endblock %}

    <style>
      /* Minimal helpful defaults */
      body { padding-top: 70px; }
      .flash-container { position: fixed; top: 70px; right: 1rem; z-index: 1055; max-width: 360px; }
      footer.site-footer { padding: 2rem 0; background: #f8f9fa; margin-top: 4rem; }
      /* Ensure Django's invalid-feedback is visible when we use it */
      .invalid-feedback { display: block; }
    </style>
  </head>

  <body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top shadow-sm">
      <div class="container">
        <a class="navbar-brand" href="/">MySite</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
                aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainNavbar">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'post_list' %}">Posts</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'about' %}">About</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'post_create' %}">Create</a></li>
          </ul>
        </div>
      </div>
    </nav>

    {# Toast-style flash messages container (fixed so they are visible during navigation) #}
    <div class="flash-container" aria-live="polite" aria-atomic="true">
      {% if messages %}
        {% for message in messages %}
          {# message.tags might be 'success', 'error', 'warning', 'info' depending on usage #}
          <div class="toast show align-items-center text-bg-{{ message.tags|default:'info' }} border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
              <div class="toast-body">
                {{ message }}
              </div>
              <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>

    <!-- MAIN CONTENT -->
    <main class="container">
      {% block content %}
      <div class="py-5 text-center">
        <h2>Welcome</h2>
        <p class="lead">
          Replace this block by extending templates and providing
          {% templatetag openblock %} block content {% templatetag closeblock %}
          {% templatetag openblock %} endblock {% templatetag closeblock %}.
        </p>
      </div>
      {% endblock %}
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <p class="mb-0 text-muted">© {% now "Y" %} MySite — built with Bootstrap & Django</p>
          </div>
          <div class="col-md-4 text-md-end">
            <small class="text-muted">Development build</small>
          </div>
        </div>
      </div>
    </footer>

    {# Bootstrap JS bundle (includes Popper) #}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>

    {# Small helper script to auto-hide toast messages after a short time #}
    <script>
      (function () {
        // Close toasts after 6 seconds
        const toasts = document.querySelectorAll('.toast');
        toasts.forEach(t => {
          setTimeout(() => {
            try { t.classList.remove('show'); } catch(e) {}
          }, 6000);
        });
      })();
    </script>

    {# Page-specific scripts can be injected by child templates #}
    {% block extra_scripts %}{% endblock %}
  </body>
</html>
